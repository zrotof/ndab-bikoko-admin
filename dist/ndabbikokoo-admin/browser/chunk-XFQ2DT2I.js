import{a as X}from"./chunk-AADQGDAQ.js";import{a as K,b as Q}from"./chunk-AHVSO3KW.js";import{a as $,b as J}from"./chunk-YEKQZTME.js";import{a as v}from"./chunk-XZITV3NF.js";import{b as H,c as U,g as G,h as L}from"./chunk-UWAIENCY.js";import{b as W,c,e as M,f as R,h as N,i as P,j,k as z,n as q,o as Y}from"./chunk-R74AP4LI.js";import{Ta as B,Ua as I,k as V,l as O,wa as w}from"./chunk-MQQ7BALU.js";import{$a as d,$b as k,Hb as s,Ia as F,La as r,Ob as A,S as u,Va as b,Z as E,_,gb as y,ja as S,jc as D,lb as p,n as T,pb as o,qb as n,rb as m,v as C,vb as x,xb as g,yb as h}from"./chunk-LNFGSNGS.js";import"./chunk-DAQOROHW.js";function ee(i,l){if(i&1){let t=x();o(0,"button",24),g("click",function(){E(t);let e=h();return _(e.onSaveTestimony())}),m(1,"i",25),s(2," Ajouter "),n()}}function te(i,l){if(i&1){let t=x();o(0,"button",24),g("click",function(){E(t);let e=h();return _(e.onEditTestimony())}),m(1,"i",26),s(2," Modifier "),n()}}function ie(i,l){i&1&&(o(0,"small"),s(1,"Image manquante"),n())}function ne(i,l){if(i&1&&(o(0,"div",16),d(1,ie,2,0,"small"),n()),i&2){let t=h();r(),p(t.formControls.image.errors!=null&&t.formControls.image.errors.required?1:-1)}}function oe(i,l){i&1&&m(0,"i",28)}function ae(i,l){i&1&&m(0,"i",5)}function se(i,l){if(i&1&&d(0,oe,1,0,"i",28)(1,ae,1,0,"i",5),i&2){let t=l.checked;p(t?0:1)}}function re(i,l){i&1&&(o(0,"div",18)(1,"label"),s(2,"Ce commentaire est-il \xE0 activer ?"),n(),o(3,"p-toggleswitch",27),d(4,se,2,1,"ng-template",null,0,k),n()())}function me(i,l){i&1&&(o(0,"small",16),s(1,"Veuillez renseignez un r\xF4le"),n())}function le(i,l){i&1&&(o(0,"small",16),s(1,"Veuillez renseigner le nom"),n())}function de(i,l){i&1&&(o(0,"small",16),s(1,"Veuillez renseigner un titre"),n())}function pe(i,l){i&1&&(o(0,"small",16),s(1,"Veuillez renseigner un message"),n())}var Ie=(()=>{class i{constructor(){this.testimonyOwnerTypes=[{type:"ADHERENT",label:"Adh\xE9rent"},{type:"BENEFICIARY",label:"B\xE9n\xE9ficiaire"}],this.PROCESS_STATE=v,this.processState=S(),this.id=S(),this.router=u(V),this.fb=u(z),this.messageService=u(w),this.testimonyService=u(X),this.isImageEdit=!1,this.isSaveButtonClicked=!1,this.isEditButtonClicked=!1,this.topHeaderPageData=D(()=>this.processState()===v.Create?{title:"Cr\xE9er Un T\xE9moignage",description:"Cr\xE9ation d'un nouvel T\xE9moignage"}:{title:"Modifier Un T\xE9moignage",description:"Modification d'un T\xE9moignage"})}get formControls(){return this.testimonyForm.controls}ngOnInit(){this.initForm(),this.checkEditMode()}initForm(){this.testimonyForm=this.fb.group({testimonyOwnerType:["",c.required],name:["",c.required],title:["",c.required],message:["",c.required],image:["",c.required],isActive:[!1,c.required]})}checkEditMode(){this.processState()===v.Edit&&this.testimonyService.getTestimonyById(this.id()).subscribe(t=>{if(t.status==="success"){this.initialTestimonyDataWhenEdit=t.data;let a=this.testimonyOwnerTypes.filter(f=>f.type===this.initialTestimonyDataWhenEdit.testimonyOwnerType);this.testimonyForm.controls.testimonyOwnerType.setValue(a[0]),this.testimonyForm.controls.name.setValue(this.initialTestimonyDataWhenEdit.name),this.testimonyForm.controls.title.setValue(this.initialTestimonyDataWhenEdit.title),this.testimonyForm.controls.message.setValue(this.initialTestimonyDataWhenEdit.message),this.testimonyForm.controls.isActive.setValue(this.initialTestimonyDataWhenEdit.isActive);let e=document.getElementById("image-previewed");this.imageDisplay=`${this.initialTestimonyDataWhenEdit.image}`,e.style.display="block",this.testimonyForm.controls.image.clearValidators(),this.testimonyForm.controls.image.updateValueAndValidity()}},()=>{this.messageService.add({severity:"warn",detail:"T\xE9moignage inexistant, contactez le webmaster"})})}onSaveTestimony(){if(this.isSaveButtonClicked=!0,this.testimonyForm.invalid)return;let t=new FormData;this.testimonyForm.get("name")?.value&&t.append("name",this.testimonyForm.get("name")?.value),this.testimonyForm.get("title")?.value&&t.append("title",this.testimonyForm.get("title")?.value),this.testimonyForm.get("message")?.value&&t.append("message",this.testimonyForm.get("message")?.value),this.testimonyForm.get("isActive")?.value&&t.append("isActive",this.testimonyForm.get("isActive")?.value),this.testimonyForm.get("image")?.value&&t.append("image",this.testimonyForm.get("image")?.value),this.testimonyForm.get("testimonyOwnerType")?.value&&t.append("testimonyOwnerType",this.testimonyForm.get("testimonyOwnerType")?.value.type),this.testimonyService.addTestimony(t).subscribe(a=>{this.messageService.add({severity:"success",detail:a.message}),T(C(2e3)).then(()=>{this.router.navigateByUrl("/temoignages")})})}onEditTestimony(){if(this.isEditButtonClicked=!0,this.testimonyForm.controls.testimonyOwnerType.value.type===this.initialTestimonyDataWhenEdit.testimonyOwnerType&&this.testimonyForm.controls.name.value===this.initialTestimonyDataWhenEdit.name&&this.testimonyForm.controls.title.value===this.initialTestimonyDataWhenEdit.title&&this.testimonyForm.controls.message.value===this.initialTestimonyDataWhenEdit.message&&this.testimonyForm.controls.isActive.value===this.initialTestimonyDataWhenEdit.isActive&&!this.isImageEdit){this.messageService.add({severity:"info",detail:"Aucune modification enregistr\xE9e"});return}let t=new FormData;this.testimonyForm.get("testimonyOwnerType")?.value.type!=this.initialTestimonyDataWhenEdit.testimonyOwnerType&&t.append("testimonyOwnerType",this.testimonyForm.get("testimonyOwnerType")?.value.type),this.testimonyForm.get("name")?.value!=this.initialTestimonyDataWhenEdit.name&&t.append("name",this.testimonyForm.get("name")?.value),this.testimonyForm.get("title")?.value!=this.initialTestimonyDataWhenEdit.town&&t.append("title",this.testimonyForm.get("title")?.value),this.testimonyForm.get("message")?.value!=this.initialTestimonyDataWhenEdit.message&&t.append("message",this.testimonyForm.get("message")?.value),this.testimonyForm.get("isActive")?.value!=this.initialTestimonyDataWhenEdit.isActive&&t.append("isActive",this.testimonyForm.get("isActive")?.value),this.isImageEdit&&t.append("image",this.testimonyForm.get("image")?.value),this.testimonyService.editTestimony(this.initialTestimonyDataWhenEdit.id,t).subscribe(a=>{a.status==="success"&&(this.messageService.add({severity:"success",detail:a.message}),T(C(2e3)).then(()=>{this.router.navigateByUrl("/temoignages")}))},()=>{this.messageService.add({severity:"info",detail:"t\xE9moignage inconnu"})})}showImagePreview(t){let a=t.target.files[0];if(a){this.isImageEdit=!0,this.testimonyForm.patchValue({image:a}),this.formControls.image.updateValueAndValidity();let e=new FileReader;e.onload=()=>{this.imageDisplay=e.result},e.readAsDataURL(a);let f=document.getElementById("image-previewed");f.style.display="block"}}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=b({type:i,selectors:[["app-testimony-add-edit-container"]],inputs:{processState:[1,"processState"],id:[1,"id"]},features:[A([w])],decls:42,vars:12,consts:[["handle",""],[1,"testimony-add-edit-container"],[3,"topHeaderData"],[1,"actions-bar"],["type","button","routerLink","/temoignages",1,"cancel"],[1,"pi","pi-times"],["type","submit",1,"add"],[3,"formGroup"],[1,"left"],[1,"preview"],["id","image-previewed",3,"src"],[1,"upload"],[1,"input"],["for","image-input"],[1,"pi","pi-upload"],["type","file","id","image-input","accept","image/*",3,"change"],[1,"error-form"],[1,"right"],[1,"field"],["formControlName","testimonyOwnerType","placeholder","S\xE9lectionnez","optionLabel","label",3,"options"],["type","text","pInputText","","formControlName","name","placeholder","Entrez le nom"],["type","text","pInputText","","formControlName","title","placeholder","Entrez le titre"],["rows","5","cols","30","pTextarea","","formControlName","message","placeholder","Entrez votre message ici"],["position","top-right"],["type","submit",1,"add",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-pencil"],["formControlName","isActive"],[1,"pi","pi-check"]],template:function(a,e){a&1&&(o(0,"div",1),m(1,"app-page-top-header",2),o(2,"div",3)(3,"button",4),m(4,"i",5),s(5," Annuler "),n(),d(6,ee,3,0,"button",6)(7,te,3,0,"button",6),n(),o(8,"form",7)(9,"div",8)(10,"div",9),m(11,"img",10),n(),o(12,"div",11)(13,"div",12)(14,"label",13),m(15,"i",14),s(16," Choisir Image "),n(),o(17,"input",15),g("change",function(Z){return e.showImagePreview(Z)}),n()(),d(18,ne,2,1,"div",16),n()(),o(19,"div",17),d(20,re,6,0,"div",18),o(21,"div",18)(22,"label"),s(23,"R\xF4le"),n(),m(24,"p-select",19),d(25,me,2,0,"small",16),n(),o(26,"div",18)(27,"label"),s(28,"Nom"),n(),m(29,"input",20),d(30,le,2,0,"small",16),n(),o(31,"div",18)(32,"label"),s(33,"Titre"),n(),m(34,"input",21),d(35,de,2,0,"small",16),n(),o(36,"div",18)(37,"label"),s(38,"Message"),n(),m(39,"textarea",22),d(40,pe,2,0,"small",16),n()()(),m(41,"p-toast",23),n()),a&2&&(r(),y("topHeaderData",e.topHeaderPageData()),r(5),p(e.processState()===e.PROCESS_STATE.Create?6:-1),r(),p(e.processState()===e.PROCESS_STATE.Edit?7:-1),r(),y("formGroup",e.testimonyForm),r(3),y("src",e.imageDisplay,F),r(7),p(e.formControls.image.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?18:-1),r(2),p(e.processState()===e.PROCESS_STATE.Edit?20:-1),r(4),y("options",e.testimonyOwnerTypes),r(),p(e.formControls.testimonyOwnerType.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?25:-1),r(5),p(e.formControls.name.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?30:-1),r(5),p(e.formControls.title.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?35:-1),r(5),p(e.formControls.message.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?40:-1))},dependencies:[O,q,N,W,M,R,P,j,U,H,J,$,L,G,Q,K,I,B,Y],styles:[`.testimony-add-edit-container{display:flex;flex-direction:column;min-height:100vh}.testimony-add-edit-container form{display:flex;justify-content:center}.testimony-add-edit-container form .left{display:flex;flex-direction:column;align-items:center;width:275px;margin-right:20px}.testimony-add-edit-container form .left .preview{width:100%;height:250px;border-radius:5px;overflow:hidden;background-color:#d3d3d3}.testimony-add-edit-container form .left .preview img{width:100%;height:100%;display:none;object-fit:cover;object-position:top}.testimony-add-edit-container form .left .upload{display:flex;flex-direction:column;align-items:flex-start;width:100%;margin-top:15px}.testimony-add-edit-container form .left .upload .input{display:flex;flex-direction:column;width:100%}.testimony-add-edit-container form .left .upload .input input{display:none}.testimony-add-edit-container form .left .upload .input label{width:100%;height:50px;padding:5px 10px;background-color:#fff;color:var(--project-primary-color);border-radius:5px;cursor:pointer;border:solid var(--project-primary-color);display:flex;align-items:center;justify-content:center}.testimony-add-edit-container form .left .upload .input label:hover{transition:all .3 ease-in-out;background-color:var(--project-primary-color);color:#fff}.testimony-add-edit-container form .left .upload .input label i{margin-right:7px}.testimony-add-edit-container form .left .upload small{margin-top:10px}.testimony-add-edit-container form .right{display:flex;justify-content:center;flex-direction:column;width:700px;border-radius:7px;background-color:#fff;padding:60px;box-shadow:#32325d40 0 13px 27px -5px,#0000004d 0 8px 16px -8px}.testimony-add-edit-container form .right .field{display:flex;flex-direction:column;width:100%;margin-bottom:20px;flex:1}.testimony-add-edit-container form .right .field label{margin-bottom:7px}.testimony-add-edit-container form .right .field small{margin:10px 0 0}.testimony-add-edit-container form .right .field .disabledInput{background-color:#d3d3d3}.testimony-add-edit-container form .right .field .enabledInput{background-color:transparent}.testimony-add-edit-container form .right .field .p-select,.testimony-add-edit-container form .right .field .p-select span{width:100%}
`],encapsulation:2})}}return i})();export{Ie as TestimonyAddEditContainerComponent};
