import{b as N}from"./chunk-SGBUOTU5.js";import{a as et}from"./chunk-2BCQRFEM.js";import{a as nt}from"./chunk-ZKEUMCPV.js";import{f as it}from"./chunk-IAIXKMEG.js";import"./chunk-HYD7DRRO.js";import{a as ot,b as at}from"./chunk-3HNSWZKV.js";import{a as g}from"./chunk-XZITV3NF.js";import{b as Z,c as tt}from"./chunk-6XYMZ6NY.js";import{b as L,c as k,e as G,f as z,h as J,i as K,j as Q,k as X,n as Y,o as rt}from"./chunk-L6GLJSXY.js";import{Ta as H,Ua as $,a as T,d as q,e as O,i as W,l as P,wa as v}from"./chunk-TXIIIGRN.js";import{h as j}from"./chunk-YVPYCT7P.js";import{Ab as y,Fb as _,Gb as F,M as U,Na as c,Pb as s,R as D,S as I,Sa as d,Wb as B,Z as E,Za as M,_ as R,db as h,ja as A,lb as x,n as C,o as f,qb as l,tc as V,ub as o,v as S,vb as n,wb as a}from"./chunk-SDVJXHAB.js";import{a as p,b as m}from"./chunk-DAQOROHW.js";var st=(()=>{class r{constructor(t){this.http=t,this.baseUrlRubric=T.baseUrl+"rubrics/",this.baseUrlArticle=T.baseUrl+"articles/",this.httpOptions={headers:new q({"Content-Type":"application/json"})}}getRubricList(){return this.http.get(this.baseUrlRubric).pipe(f(({status:t,data:i,message:e})=>i))}getArticleList(t){let i=this.baseUrlArticle;return t&&(i=`${i}?rubricId=${t}`),this.http.get(i).pipe(f(({status:e,data:u,message:w})=>u))}getRubricById(t){return this.http.get(this.baseUrlRubric+`${t}`,this.httpOptions)}getArticleById(t){return this.http.get(this.baseUrlArticle+`${t}`,this.httpOptions)}addRubric(t){return this.http.post(this.baseUrlRubric,t,this.httpOptions)}addArticle(t){return this.http.post(this.baseUrlArticle,t)}editRubric(t,i){return this.http.put(this.baseUrlRubric+`${t}`,i,this.httpOptions)}editArticle(t,i){return this.http.put(this.baseUrlArticle+`${t}`,i)}deleteRubric(t){return this.http.delete(this.baseUrlRubric+`${t}`)}deleteArticle(t){return this.http.delete(this.baseUrlArticle+`${t}`)}updateArticleRubricsOrder(t){return this.http.put(this.baseUrlRubric+"update-article-rubric-list-order",t).pipe(f(({status:i,data:e,message:u})=>u))}static{this.\u0275fac=function(i){return new(i||r)(D(O))}}static{this.\u0275prov=U({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ut(r,b){if(r&1){let t=y();o(0,"button",12),_("click",function(){E(t);let e=F();return R(e.onSaveRubric())}),a(1,"i",13),s(2," Ajouter "),n()}}function pt(r,b){if(r&1){let t=y();o(0,"button",12),_("click",function(){E(t);let e=F();return R(e.onEditRubric())}),a(1,"i",14),s(2," Modifier "),n()}}function mt(r,b){r&1&&(o(0,"div",7)(1,"label"),s(2,"Activer?"),n(),a(3,"p-toggleswitch",15),n())}function ht(r,b){r&1&&(o(0,"small",9),s(1,"Renseigner le nom de la rubrique"),n())}function bt(r,b){r&1&&(o(0,"small",9),s(1,"Renseigner une courte description"),n())}var Ht=(()=>{class r{constructor(t,i,e,u,w,ct){this.fb=t,this.artcileService=i,this.messageService=e,this.location=u,this.activatedRoute=w,this.authService=ct,this.PROCESS_STATE=g,this.processState=A(),this.id=A(),this.blogService=I(nt),this.isSaveButtonClicked=!1,this.isEditButtonClicked=!1,this.isEditMode=!1,this.topHeaderPageData=V(()=>this.processState()===g.Create?{title:"Cr\xE9er Une Rubrique",description:"Cr\xE9ation d'une nouvelle rubrique d'articles"}:{title:"Modifier Une Rubrique",description:"Modification d'une rubrique d'articles"})}ngOnInit(){this.initForm(),this.checkEditMode(),this.getUserConnected()}initForm(){this.rubricForm=this.fb.group({name:["",k.required],description:["",k.required],isActive:[!1]})}get formControls(){return this.rubricForm.controls}checkEditMode(){this.processState()===g.Edit&&this.blogService.getBlogRubricById(this.id()).subscribe(t=>{t.status==="success"&&(this.initialReplayDataWhenEdit=t.data,this.rubricForm.controls.name.setValue(this.initialReplayDataWhenEdit.name),this.rubricForm.controls.description.setValue(this.initialReplayDataWhenEdit.description),this.rubricForm.controls.isActive.setValue(this.initialReplayDataWhenEdit.isActive))},()=>{this.messageService.add({severity:"warn",detail:"Rubrique inexistant, contactez le webmaster"})})}getUserConnected(){this.connectedUser=this.activatedRoute.snapshot.data.user}onSaveRubric(){if(this.isSaveButtonClicked=!0,this.rubricForm.invalid)return;let t={name:this.rubricForm.get("name")?.value,description:this.rubricForm.get("description")?.value,isActive:this.rubricForm.get("isActive")?.value,userId:this.connectedUser?.id};this.blogService.addRubric(t).subscribe(i=>{this.messageService.add({severity:"success",detail:i.message}),C(S(2e3)).then(()=>{this.location.back()})})}onEditRubric(){if(this.isEditButtonClicked=!0,this.rubricForm.controls.name.value===this.initialReplayDataWhenEdit.name&&this.rubricForm.controls.description.value===this.initialReplayDataWhenEdit.description&&this.rubricForm.controls.isActive.value===this.initialReplayDataWhenEdit.isActive){this.messageService.add({severity:"info",detail:"Aucune modification enregistr\xE9e"});return}let t={};this.rubricForm.controls.name.value!==this.initialReplayDataWhenEdit.name&&(t=m(p({},t),{name:this.rubricForm.controls.name.value})),this.rubricForm.controls.description.value!==this.initialReplayDataWhenEdit.description&&(t=m(p({},t),{description:this.rubricForm.controls.description.value})),this.rubricForm.controls.isActive.value!==this.initialReplayDataWhenEdit.isActive&&(t=m(p({},t),{isActive:this.rubricForm.controls.isActive.value})),t=m(p({},t),{userId:this.connectedUser?.id}),this.blogService.editRubric(this.initialReplayDataWhenEdit.id,t).subscribe(i=>{i.status==="success"&&(this.messageService.add({severity:"success",detail:i.message}),C(S(2e3)).then(()=>{this.location.back()}))},()=>{this.messageService.add({severity:"info",detail:"Programme inconnue"})})}static{this.\u0275fac=function(i){return new(i||r)(d(X),d(st),d(v),d(j),d(W),d(N))}}static{this.\u0275cmp=M({type:r,selectors:[["app-article-rubric-add-edit-container"]],inputs:{processState:[1,"processState"],id:[1,"id"]},features:[B([v])],decls:21,vars:7,consts:[[1,"rubric-add-edit-container","pages"],[3,"topHeaderData"],[1,"actions-bar"],["type","button","routerLink","/blog/rubriques",1,"cancel"],[1,"pi","pi-times"],["type","submit",1,"add"],[3,"formGroup"],[1,"field"],["type","text","pInputText","","formControlName","name","placeholder","Entrez le nom de la rubrique"],[1,"error-form"],["type","text","pInputText","","formControlName","description","placeholder","Entrez ce \xE0 quoi servira la rubrique"],["position","top-right"],["type","submit",1,"add",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-pencil"],["formControlName","isActive"]],template:function(i,e){i&1&&(o(0,"div",0),a(1,"app-page-top-header",1),o(2,"div",2)(3,"button",3),a(4,"i",4),s(5," Annuler "),n(),h(6,ut,3,0,"button",5)(7,pt,3,0,"button",5),n(),o(8,"form",6),h(9,mt,4,0,"div",7),o(10,"div",7)(11,"label"),s(12,"Nom de la rubrique"),n(),a(13,"input",8),h(14,ht,2,0,"small",9),n(),o(15,"div",7)(16,"label"),s(17,"Description"),n(),a(18,"input",10),h(19,bt,2,0,"small",9),n()(),a(20,"p-toast",11),n()),i&2&&(c(),x("topHeaderData",e.topHeaderPageData()),c(5),l(e.processState()===e.PROCESS_STATE.Create?6:-1),c(),l(e.processState()===e.PROCESS_STATE.Edit?7:-1),c(),x("formGroup",e.rubricForm),c(),l(e.processState()===e.PROCESS_STATE.Edit?9:-1),c(5),l(e.formControls.name.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?14:-1),c(5),l(e.formControls.description.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?19:-1))},dependencies:[P,it,$,H,Y,J,L,G,z,K,Q,tt,Z,et,at,ot,rt],styles:[`.rubric-add-edit-container{display:flex;flex-direction:column;min-height:100vh}.rubric-add-edit-container .actions{display:flex;justify-content:flex-end;padding:5px 10px;background-color:#f1f1f1;margin:60px 0 30px}.rubric-add-edit-container .actions button{display:flex;align-items:center;outline:none;padding:6px 10px;border-radius:100px;color:green;width:fit-content;cursor:pointer;background-color:#fff;margin-left:10px}.rubric-add-edit-container .actions button i{margin-right:5px}.rubric-add-edit-container form{display:flex;flex-direction:column;width:500px;border-radius:7px;margin:0 auto;background-color:#fff;padding:60px;box-shadow:#32325d40 0 13px 27px -5px,#0000004d 0 8px 16px -8px}.rubric-add-edit-container form .field{display:flex;flex-direction:column;margin-bottom:20px;flex:1}.rubric-add-edit-container form .field label{margin-bottom:7px}@media all and (max-width: 990px){.add-rubric form{width:100%}}@media all and (max-width: 990px){.add-rubric form{padding:20px}}
`],encapsulation:2})}}return r})();export{Ht as ArticleRubricAddEditContainerComponent};
