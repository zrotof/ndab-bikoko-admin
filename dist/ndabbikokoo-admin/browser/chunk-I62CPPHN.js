import{a as ee,b as te}from"./chunk-WJ2XH636.js";import{a as X,b as Z}from"./chunk-YEKQZTME.js";import{a as E}from"./chunk-XZITV3NF.js";import{a as ne}from"./chunk-FRP3AOF3.js";import{b as Y,c as $,g as J,h as K}from"./chunk-UWAIENCY.js";import{b as R,c,e as q,f as j,h as H,i as U,j as z,k as G,n as O,o as Q}from"./chunk-R74AP4LI.js";import{Aa as M,Ta as W,Ua as N,k as L,l as B,wa as _}from"./chunk-MQQ7BALU.js";import{$a as s,Hb as o,Ia as w,La as l,Ob as I,Pb as V,S as h,Va as k,Z as b,_ as S,gb as u,ja as P,jb as T,jc as D,lb as p,n as C,pb as a,qb as n,rb as d,v as y,vb as F,wc as A,xb as f,yb as g}from"./chunk-LNFGSNGS.js";import"./chunk-DAQOROHW.js";var x=[{type:"AG",label:"Assembl\xE9e g\xE9n\xE9rale"},{type:"IC",label:"Installation de canton"},{type:"SEMINAR",label:"S\xE9minaire"},{type:"BIRTHDAY",label:"Anniversaire"}];var ae=()=>({height:"320px"});function oe(i,m){if(i&1){let t=F();a(0,"button",29),f("click",function(){b(t);let e=g();return S(e.onSavePlanner())}),d(1,"i",30),o(2," Ajouter "),n()}}function re(i,m){if(i&1){let t=F();a(0,"button",29),f("click",function(){b(t);let e=g();return S(e.onEditPlanner())}),d(1,"i",31),o(2," Modifier "),n()}}function le(i,m){i&1&&(a(0,"small"),o(1,"Image manquante"),n())}function de(i,m){if(i&1&&(a(0,"div",15),s(1,le,2,0,"small"),n()),i&2){let t=g();l(),p(t.formControls.coverImage.errors!=null&&t.formControls.coverImage.errors.required?1:-1)}}function se(i,m){i&1&&(a(0,"small",15),o(1,"S\xE9lectionnez un \xE9v\xEAnement"),n())}function pe(i,m){i&1&&(a(0,"small",15),o(1,"Renseigner la date"),n())}function me(i,m){i&1&&(a(0,"small",15),o(1,"Renseigner la ville"),n())}function ce(i,m){i&1&&(a(0,"small",15),o(1,"Renseigner le pays"),n())}function ue(i,m){i&1&&(a(0,"small",15),o(1,"Renseigner le m\xE9dia vid\xE9o"),n())}function he(i,m){i&1&&(a(0,"span",32),d(1,"button",33)(2,"button",34)(3,"button",35)(4,"button",36)(5,"button",37)(6,"button",38)(7,"button",39)(8,"button",40)(9,"button",41),n())}function ve(i,m){i&1&&(a(0,"small",15),o(1,"Renseigner le contenu de l'article"),n())}var He=(()=>{class i{constructor(){this.PLANNER_TYPES=x,this.PROCESS_STATE=E,this.processState=P(),this.id=P(),this.router=h(L),this.fb=h(G),this.messageService=h(_),this.plannerService=h(ne),this.topHeaderPageData=D(()=>this.processState()===E.Create?{title:"Cr\xE9er Un \xC9v\xE8nement",description:"Cr\xE9ation d'un nouvel \xE9v\xE8nement"}:{title:"Modifier Un \xC9v\xE8nement",description:"Modification d'un \xE9v\xE8nement"}),this.isSaveButtonClicked=!1,this.isEditButtonClicked=!1,this.isEditMode=!1,this.isImageEdit=!1,this.isMediaVideoInputIsToDisable=!0}get formControls(){return this.plannerForm.controls}ngOnInit(){this.initForm(),this.checkEditMode(),this.onHandlingMedia()}initForm(){this.plannerForm=this.fb.group({eventType:["",c.required],date:["",c.required],town:["",c.required],country:["",c.required],hasVideo:[!1],videoLink:[{value:"",disabled:!0}],content:["",c.required],coverImage:["",c.required]})}onHandlingMedia(){this.plannerForm.controls.hasVideo.valueChanges.subscribe(t=>{t?(this.plannerForm.controls.videoLink.enable(),this.plannerForm.controls.videoLink.setValidators(c.required)):(this.plannerForm.controls.videoLink.setValue(""),this.plannerForm.controls.videoLink.disable(),this.plannerForm.controls.videoLink.removeValidators(c.required)),this.isMediaVideoInputIsToDisable=!this.isMediaVideoInputIsToDisable,this.plannerForm.controls.videoLink.updateValueAndValidity()})}checkEditMode(){this.processState()===E.Edit&&this.plannerService.getPlannerById(this.id()).subscribe(t=>{if(t.status==="success"){this.initialPlannerDataWhenEdit=t.data;let r=x.filter(v=>v.type===this.initialPlannerDataWhenEdit.type);this.plannerForm.controls.eventType.setValue(r[0]),this.plannerForm.controls.date.setValue(this.initialPlannerDataWhenEdit.date),this.plannerForm.controls.town.setValue(this.initialPlannerDataWhenEdit.town),this.plannerForm.controls.country.setValue(this.initialPlannerDataWhenEdit.country),this.plannerForm.controls.hasVideo.setValue(this.initialPlannerDataWhenEdit.hasVideo),this.plannerForm.controls.videoLink.setValue(this.initialPlannerDataWhenEdit.videoLink),this.plannerForm.controls.content.setValue(this.initialPlannerDataWhenEdit.content);let e=document.getElementById("image-previewed");this.imageDisplay=`${this.initialPlannerDataWhenEdit.coverImage}`,e.style.display="block",this.plannerForm.controls.coverImage.clearValidators(),this.plannerForm.controls.coverImage.updateValueAndValidity()}},()=>{this.messageService.add({severity:"warn",detail:"\xC9v\xEAnement inexistant, contactez le webmaster"})})}getUserConnected(){}onSavePlanner(){if(this.isSaveButtonClicked=!0,this.plannerForm.invalid)return;let t=new FormData;this.plannerForm.get("eventType")?.value&&t.append("type",this.plannerForm.get("eventType")?.value.type),this.plannerForm.get("date")?.value&&t.append("date",this.plannerForm.get("date")?.value),this.plannerForm.get("town")?.value&&t.append("town",this.plannerForm.get("town")?.value),this.plannerForm.get("country")?.value&&t.append("country",this.plannerForm.get("country")?.value),this.plannerForm.get("hasVideo")?.value&&t.append("hasVideo",this.plannerForm.get("hasVideo")?.value),this.plannerForm.get("videoLink")?.value&&t.append("videoLink",this.plannerForm.get("videoLink")?.value),this.plannerForm.get("content")?.value&&t.append("content",this.plannerForm.get("content")?.value),this.plannerForm.get("coverImage")?.value&&t.append("coverImage",this.plannerForm.get("coverImage")?.value),t.append("userId","1"),this.plannerService.addPlanner(t).subscribe(r=>{this.messageService.add({severity:"success",detail:r.message}),C(y(2e3)).then(()=>{this.router.navigateByUrl("/evenements")})})}onEditPlanner(){if(this.isEditButtonClicked=!0,this.plannerForm.controls.eventType.value.type===this.initialPlannerDataWhenEdit.type&&this.plannerForm.controls.date.value===this.initialPlannerDataWhenEdit.date&&this.plannerForm.controls.town.value===this.initialPlannerDataWhenEdit.town&&this.plannerForm.controls.country.value===this.initialPlannerDataWhenEdit.country&&this.plannerForm.controls.hasVideo.value===this.initialPlannerDataWhenEdit.hasVideo&&this.plannerForm.controls.videoLink.value===this.initialPlannerDataWhenEdit.videoLink&&this.plannerForm.controls.content.value===this.initialPlannerDataWhenEdit.content&&!this.isImageEdit){this.messageService.add({severity:"info",detail:"Aucune modification enregistr\xE9e"});return}let t=new FormData;this.plannerForm.get("eventType")?.value.type!=this.initialPlannerDataWhenEdit.type&&t.append("type",this.plannerForm.get("eventType")?.value.type),this.plannerForm.get("date")?.value!=this.initialPlannerDataWhenEdit.date&&t.append("date",this.plannerForm.get("date")?.value),this.plannerForm.get("town")?.value!=this.initialPlannerDataWhenEdit.town&&t.append("town",this.plannerForm.get("town")?.value),this.plannerForm.get("country")?.value!=this.initialPlannerDataWhenEdit.country&&t.append("country",this.plannerForm.get("country")?.value),this.plannerForm.get("hasVideo")?.value!=this.initialPlannerDataWhenEdit.hasVideo&&t.append("hasVideo",this.plannerForm.get("hasVideo")?.value),this.plannerForm.get("videoLink")?.value!=this.initialPlannerDataWhenEdit.videoLink&&t.append("videoLink",this.plannerForm.get("videoLink")?.value),this.plannerForm.get("content")?.value!=this.initialPlannerDataWhenEdit.content&&t.append("content",this.plannerForm.get("content")?.value),this.isImageEdit&&t.append("coverImage",this.plannerForm.get("coverImage")?.value),t.append("userId","1"),this.plannerService.editPlannerById(this.initialPlannerDataWhenEdit.id,t).subscribe(r=>{r.status==="success"&&(this.messageService.add({severity:"success",detail:r.message}),C(y(2e3)).then(()=>{this.router.navigateByUrl("/evenements")}))},()=>{this.messageService.add({severity:"info",detail:"Programme inconnue"})})}showImagePreview(t){let r=t.target.files[0];if(r){this.isImageEdit=!0,this.plannerForm.patchValue({coverImage:r}),this.formControls.coverImage.updateValueAndValidity();let e=new FileReader;e.onload=()=>{this.imageDisplay=e.result},e.readAsDataURL(r);let v=document.getElementById("image-previewed");v.style.display="block"}}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=k({type:i,selectors:[["app-planner-add-edit-container"]],inputs:{processState:[1,"processState"],id:[1,"id"]},features:[I([_])],decls:60,vars:17,consts:[[1,"planner-add-edit-containe","pages"],[3,"topHeaderData"],[1,"actions-bar"],["type","button","routerLink","/evenements",1,"cancel"],[1,"pi","pi-times"],["type","submit",1,"add"],[3,"formGroup"],[1,"left"],[1,"preview"],["id","image-previewed",3,"src"],[1,"upload"],[1,"input"],["for","image-input"],[1,"pi","pi-upload"],["type","file","id","image-input","accept","image/*",3,"change"],[1,"error-form"],[1,"right"],[1,"row-two"],[1,"field"],["formControlName","eventType","placeholder","S\xE9lectionnez","optionLabel","label",3,"options"],["type","text","pInputText","","formControlName","date","placeholder","Exemple: 12-15 Mai 2022"],["type","text","pInputText","","formControlName","town","placeholder","Ville de l'\xE9v\xEAnement"],["type","text","pInputText","","formControlName","country","placeholder","Pays de l'\xE9v\xEAnement"],["formControlName","hasVideo"],["type","text","pInputText","","formControlName","videoLink",3,"ngClass"],[1,"row-one"],["formControlName","content","placeholder","Renseignez le corps de l'article ici !"],["pTemplate","header"],["position","top-right"],["type","submit",1,"add",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-pencil"],[1,"ql-formats"],["value","1",1,"ql-header"],["value","2",1,"ql-header"],["value","false",1,"ql-header"],["type","button","aria-label","Bold",1,"ql-bold"],["type","button","aria-label","Italic",1,"ql-italic"],["type","button","aria-label","Underline",1,"ql-underline"],["type","button","value","ordered",1,"ql-list"],["type","button","value","bullet",1,"ql-list"],["type","button",1,"ql-link"]],template:function(r,e){r&1&&(a(0,"div",0),d(1,"app-page-top-header",1),a(2,"div",2)(3,"button",3),d(4,"i",4),o(5," Annuler "),n(),s(6,oe,3,0,"button",5)(7,re,3,0,"button",5),n(),a(8,"form",6)(9,"div",7)(10,"div",8),d(11,"img",9),n(),a(12,"div",10)(13,"div",11)(14,"label",12),d(15,"i",13),o(16," Image de couverture "),n(),a(17,"input",14),f("change",function(ie){return e.showImagePreview(ie)}),n()(),s(18,de,2,1,"div",15),n()(),a(19,"div",16)(20,"div",17)(21,"div",18)(22,"label"),o(23,"Type d'\xE9v\xEAnement"),n(),d(24,"p-select",19),s(25,se,2,0,"small",15),n(),a(26,"div",18)(27,"label"),o(28,"Dates de l'\xE9v\xEAnement"),n(),d(29,"input",20),s(30,pe,2,0,"small",15),n()(),a(31,"div",17)(32,"div",18)(33,"label"),o(34,"Ville"),n(),d(35,"input",21),s(36,me,2,0,"small",15),n(),a(37,"div",18)(38,"label"),o(39,"Pays"),n(),d(40,"input",22),s(41,ce,2,0,"small",15),n()(),a(42,"div",17)(43,"div",18)(44,"label"),o(45,"Contiendra une vid\xE9o?"),n(),d(46,"p-toggleswitch",23),n(),a(47,"div",18)(48,"label"),o(49,"Media video"),n(),d(50,"input",24),s(51,ue,2,0,"small",15),n()(),a(52,"div",25)(53,"div",18)(54,"label"),o(55,"Corps de l'article"),n(),a(56,"p-editor",26),s(57,he,10,0,"ng-template",27),n(),s(58,ve,2,0,"small",15),n()()()(),d(59,"p-toast",28),n()),r&2&&(l(),u("topHeaderData",e.topHeaderPageData()),l(5),p(e.processState()===e.PROCESS_STATE.Create?6:-1),l(),p(e.processState()===e.PROCESS_STATE.Edit?7:-1),l(),u("formGroup",e.plannerForm),l(3),u("src",e.imageDisplay,w),l(7),p(e.formControls.coverImage.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?18:-1),l(6),u("options",e.PLANNER_TYPES),l(),p(e.formControls.eventType.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?25:-1),l(5),p(e.formControls.date.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?30:-1),l(6),p(e.formControls.date.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?36:-1),l(5),p(e.formControls.date.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?41:-1),l(9),u("ngClass",e.formControls.hasVideo.value?"enabledInput":"disabledInput"),l(),p(e.formControls.videoLink.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?51:-1),l(5),T(V(16,ae)),l(2),p(e.formControls.content.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)?58:-1))},dependencies:[A,B,O,H,R,q,j,U,z,$,Y,K,J,M,Z,X,te,ee,N,W,Q],styles:[`.planner-add-edit-containe{display:flex;flex-direction:column;min-height:100vh}.planner-add-edit-containe form{display:flex;justify-content:center}.planner-add-edit-containe form .left{display:flex;flex-direction:column;align-items:center;width:275px;margin-right:20px}.planner-add-edit-containe form .left .preview{width:100%;height:250px;border-radius:5px;overflow:hidden;background-color:#d3d3d3}.planner-add-edit-containe form .left .preview img{width:100%;height:100%;display:none;object-fit:cover;object-position:top}.planner-add-edit-containe form .left .upload{display:flex;flex-direction:column;align-items:flex-start;width:100%;margin-top:15px}.planner-add-edit-containe form .left .upload .input{display:flex;flex-direction:column;width:100%}.planner-add-edit-containe form .left .upload .input input{display:none}.planner-add-edit-containe form .left .upload .input label{width:100%;height:50px;padding:5px 10px;background-color:#fff;color:var(--project-primary-color);border-radius:5px;cursor:pointer;border:solid var(--project-primary-color);display:flex;align-items:center;justify-content:center}.planner-add-edit-containe form .left .upload .input label:hover{transition:all .3 ease-in-out;background-color:var(--project-primary-color);color:#fff}.planner-add-edit-containe form .left .upload .input label i{margin-right:7px}.planner-add-edit-containe form .left .upload small{margin-top:10px}.planner-add-edit-containe form .right{display:flex;justify-content:center;flex-direction:column;width:700px;border-radius:7px;background-color:#fff;padding:60px;box-shadow:#32325d40 0 13px 27px -5px,#0000004d 0 8px 16px -8px}.planner-add-edit-containe form .right .row-one{width:100%}.planner-add-edit-containe form .right .row-two{display:flex;gap:1rem}.planner-add-edit-containe form .right .field{display:flex;flex-direction:column;width:100%;margin-bottom:20px;flex:1}.planner-add-edit-containe form .right .field label{margin-bottom:7px}.planner-add-edit-containe form .right .field small{margin:10px 0 0}.planner-add-edit-containe form .right .field .disabledInput{background-color:#d3d3d3}.planner-add-edit-containe form .right .field .enabledInput{background-color:transparent}.planner-add-edit-containe form .right .field .p-button{color:#fff;background:var(--project-primary-color);border:1px solid var(--project-primary-color)}.planner-add-edit-containe form .right .field .p-select,.planner-add-edit-containe form .right .field .p-select span{width:100%}
`],encapsulation:2})}}return i})();export{He as PlannerAddEditContainerComponent};
