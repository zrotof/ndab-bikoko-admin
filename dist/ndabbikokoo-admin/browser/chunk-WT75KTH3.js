import{b as ue}from"./chunk-5ENPGLZA.js";import{a as ne}from"./chunk-FH3KJSCL.js";import{a as de}from"./chunk-7ZYIHZCL.js";import{d as oe}from"./chunk-SNFI66SJ.js";import{a as me,b as pe}from"./chunk-SFVALG4N.js";import{a as ce,b as se}from"./chunk-GU5SMQBJ.js";import{a as b}from"./chunk-XZITV3NF.js";import{a as te,b as ie}from"./chunk-U2DIKO2V.js";import{b as Z,c as ee,g as re,h as ae}from"./chunk-EQBWRM3H.js";import{b as O,c as p,e as G,f as $,h as J,i as K,j as Q,k as X,n as Y}from"./chunk-JUHVJHN3.js";import{a as le}from"./chunk-XYTUDMC5.js";import"./chunk-U47Z3OXB.js";import{Pa as U,Qa as H,e as P,g as q,h as z,sa as E}from"./chunk-IY7SHYKA.js";import"./chunk-H25HSPWU.js";import{$a as s,Cc as N,Hb as o,Ia as _,La as l,Ob as T,Pb as B,Qa as f,S as y,Va as D,Yb as M,Z as F,Zb as W,_ as S,gb as d,ja as x,jb as V,jc as L,lb as I,n as C,o as w,pb as a,qb as i,rb as c,v as A,vb as k,wc as R,xb as g,yb as v,zc as j}from"./chunk-LNFGSNGS.js";import"./chunk-DAQOROHW.js";var he=()=>({height:"320px"});function fe(r,m){if(r&1){let t=k();a(0,"button",30),g("click",function(){F(t);let e=v();return S(e.onSaveArticle())}),c(1,"i",31),o(2," Ajouter "),i()}}function ge(r,m){if(r&1){let t=k();a(0,"button",30),g("click",function(){F(t);let e=v();return S(e.onEditArticle())}),c(1,"i",32),o(2," Modifier "),i()}}function ve(r,m){r&1&&(a(0,"small"),o(1,"Image manquante"),i())}function Ee(r,m){if(r&1&&(a(0,"div",33),s(1,ve,2,0,"small",34),i()),r&2){let t=v();l(),d("ngIf",t.formControls.coverImage.errors==null?null:t.formControls.coverImage.errors.required)}}function be(r,m){r&1&&(a(0,"small",33),o(1,"S\xE9lectionnez une rubrique d'article"),i())}function Ce(r,m){r&1&&(a(0,"small",33),o(1,"Renseigner le titre de l'article"),i())}function Ae(r,m){r&1&&(a(0,"small",33),o(1,"Renseigner une courte description"),i())}function ye(r,m){r&1&&(a(0,"small",33),o(1,"Renseigner la date de l'\xE9v\xEAnement"),i())}function Fe(r,m){r&1&&(a(0,"small",33),o(1,"Renseigner le m\xE9dia vid\xE9o"),i())}function Se(r,m){r&1&&(a(0,"small",33),o(1,"Renseigner le contenu de l'article"),i())}var tt=(()=>{class r{constructor(t,n,e){this.fb=t,this.messageService=n,this.activatedRoute=e,this.PROCESS_STATE=b,this.processState=x(),this.router=y(q),this.id=x(),this.blogService=y(de),this.blogRubrics$=this.blogService.getBlogRubrics().pipe(w(u=>u.map(h=>({id:h.id,name:h.name})))),this.isSaveButtonClicked=!1,this.isEditButtonClicked=!1,this.isEditMode=!1,this.isImageEdit=!1,this.isMediaVideoInputIsToDisable=!0,this.topHeaderPageData=L(()=>this.processState()===b.Create?{title:"Cr\xE9er Un d'Article",description:"Cr\xE9ation d'un nouvel article"}:{title:"Modifier Un Article",description:"Modification d'un article"})}ngOnInit(){this.initForm(),this.checkEditMode(),this.getUserConnected(),this.onHandlingMedia()}initForm(){this.articleForm=this.fb.group({title:["",p.required],description:["",p.required],date:["",p.required],hour:[""],content:["",p.required],hasVideo:[!1],videoLink:[""],coverImage:["",p.required],rubric:["",p.required]})}onHandlingMedia(){this.articleForm.controls.hasVideo.valueChanges.subscribe(t=>{t?(this.articleForm.controls.videoLink.enable(),this.articleForm.controls.videoLink.setValidators(p.required)):(this.articleForm.controls.videoLink.setValue(""),this.articleForm.controls.videoLink.disable(),this.articleForm.controls.videoLink.removeValidators(p.required)),this.isMediaVideoInputIsToDisable=!this.isMediaVideoInputIsToDisable,this.articleForm.controls.videoLink.updateValueAndValidity()})}get formControls(){return this.articleForm.controls}checkEditMode(){this.processState()===b.Edit&&this.blogService.getBlogArticleById(this.id()).subscribe(t=>{if(t.status==="success"){this.initialArticleDataWhenEdit=t.data,this.articleForm.controls.title.setValue(this.initialArticleDataWhenEdit.title),this.articleForm.controls.description.setValue(this.initialArticleDataWhenEdit.description),this.articleForm.controls.date.setValue(new Date(this.initialArticleDataWhenEdit.date)),this.articleForm.controls.hour.setValue(this.initialArticleDataWhenEdit.hour),this.articleForm.controls.content.setValue(this.initialArticleDataWhenEdit.content),this.articleForm.controls.hasVideo.setValue(this.initialArticleDataWhenEdit.hasVideo),this.articleForm.controls.videoLink.setValue(this.initialArticleDataWhenEdit.videoLink),this.blogRubrics$.subscribe({next:e=>{let u=e.filter(h=>h.id===this.initialArticleDataWhenEdit.rubricId);this.articleForm.controls.rubric.setValue(u[0])}});let n=document.getElementById("image-previewed");this.imageDisplay=`${this.initialArticleDataWhenEdit.coverImage}`,n.style.display="block",this.articleForm.controls.coverImage.clearValidators(),this.articleForm.controls.coverImage.updateValueAndValidity()}},()=>{this.messageService.add({severity:"warn",detail:"Article inexistant, contactez le webmaster"})})}getUserConnected(){this.connectedUser=this.activatedRoute.snapshot.data.user}onSaveArticle(){if(this.isSaveButtonClicked=!0,this.articleForm.invalid)return;let t=new FormData;this.articleForm.get("title")?.value&&t.append("title",this.articleForm.get("title")?.value),this.articleForm.get("description")?.value&&t.append("description",this.articleForm.get("description")?.value),this.articleForm.get("date")?.value&&t.append("date",this.articleForm.get("date")?.value),this.articleForm.get("hour")?.value&&t.append("hour",this.articleForm.get("hour")?.value),this.articleForm.get("hasVideo")?.value&&t.append("hasVideo",this.articleForm.get("hasVideo")?.value),this.articleForm.get("videoLink")?.value&&t.append("videoLink",this.articleForm.get("videoLink")?.value),this.articleForm.get("coverImage")?.value&&t.append("coverImage",this.articleForm.get("coverImage")?.value),this.articleForm.get("content")?.value&&t.append("content",this.articleForm.get("content")?.value),this.articleForm.get("rubric")?.value&&t.append("rubricId",this.articleForm.get("rubric")?.value.id),t.append("userId","1"),this.blogService.addArticle(t).subscribe(n=>{this.messageService.add({severity:"success",detail:n.message}),C(A(2e3)).then(()=>{this.router.navigateByUrl("/blog/articles")})})}onEditArticle(){if(this.isEditButtonClicked=!0,this.articleForm.controls.title.value===this.initialArticleDataWhenEdit.title&&this.articleForm.controls.description.value===this.initialArticleDataWhenEdit.description&&this.articleForm.controls.date.value.getTime()===new Date(this.initialArticleDataWhenEdit.date).getTime()&&this.articleForm.controls.hour.value===this.initialArticleDataWhenEdit.hour&&this.articleForm.controls.content.value===this.initialArticleDataWhenEdit.content&&this.articleForm.controls.hasVideo.value===this.initialArticleDataWhenEdit.hasVideo&&this.articleForm.controls.videoLink.value===this.initialArticleDataWhenEdit.videoLink&&this.articleForm.controls.rubric.value.id===this.initialArticleDataWhenEdit.rubricId&&!this.isImageEdit){this.messageService.add({severity:"info",detail:"Aucune modification enregistr\xE9e"});return}let t=new FormData;this.articleForm.get("title")?.value!=this.initialArticleDataWhenEdit.title&&t.append("title",this.articleForm.get("title")?.value),this.articleForm.get("description")?.value!=this.initialArticleDataWhenEdit.description&&t.append("description",this.articleForm.get("description")?.value),this.articleForm.get("date")?.value.getTime()!=new Date(this.initialArticleDataWhenEdit.date).getTime()&&t.append("date",this.articleForm.get("date")?.value),this.articleForm.get("hour")?.value!=this.initialArticleDataWhenEdit.hour&&t.append("hour",this.articleForm.get("hour")?.value),this.articleForm.get("hasVideo")?.value!=this.initialArticleDataWhenEdit.hasVideo&&t.append("hasVideo",this.articleForm.get("hasVideo")?.value),this.articleForm.get("videoLink")?.value!=this.initialArticleDataWhenEdit.videoLink&&t.append("videoLink",this.articleForm.get("videoLink")?.value),this.isImageEdit&&t.append("coverImage",this.articleForm.get("coverImage")?.value),this.articleForm.get("content")?.value!=this.initialArticleDataWhenEdit.content&&t.append("content",this.articleForm.get("content")?.value),this.articleForm.get("rubric")?.value.id!=this.initialArticleDataWhenEdit.rubricId&&t.append("rubricId",this.articleForm.get("rubric")?.value.id),t.append("userId","1"),this.blogService.editArticle(this.initialArticleDataWhenEdit.id,t).subscribe(n=>{n.status==="success"&&(this.messageService.add({severity:"success",detail:n.message}),C(A(2e3)).then(()=>{this.router.navigateByUrl("/blog/articles")}))},()=>{this.messageService.add({severity:"info",detail:"Programme inconnue"})})}showImagePreview(t){let n=t.target.files[0];if(n){this.isImageEdit=!0,this.articleForm.patchValue({coverImage:n}),this.formControls.coverImage.updateValueAndValidity();let e=new FileReader;e.onload=()=>{this.imageDisplay=e.result},e.readAsDataURL(n);let u=document.getElementById("image-previewed");u.style.display="block"}}static{this.\u0275fac=function(n){return new(n||r)(f(X),f(E),f(P))}}static{this.\u0275cmp=D({type:r,selectors:[["app-article-add-edit-container"]],inputs:{processState:[1,"processState"],id:[1,"id"]},features:[T([E])],decls:66,vars:25,consts:[[1,"article-add-edit-container","pages"],[3,"topHeaderData"],[1,"actions-bar"],["type","button","routerLink","/blog/articles",1,"cancel"],[1,"pi","pi-times"],["type","submit",1,"add"],[3,"formGroup"],[1,"left"],[1,"preview"],["id","image-previewed",3,"src"],[1,"upload"],[1,"input"],["for","image-input"],[1,"pi","pi-upload"],["type","file","id","image-input","accept","image/*",3,"change"],["class","error-form",4,"ngIf"],[1,"right"],[1,"row-one"],[1,"field"],["formControlName","rubric","placeholder","S\xE9lectionnez une rubrique d'article","filterBy","name","optionLabel","name",3,"options","filter","showClear"],["type","text","pInputText","","formControlName","title","placeholder","Entrez de le titre de l'article"],["type","text","pInputText","","formControlName","description","placeholder","Entrez une description"],[1,"row-two","calendar-bloc"],["placeholder","Entrez l'heure","formControlName","hour","timeSeparator",":","dataType","string",3,"readonlyInput","timeOnly"],["placeholder","Entrez la date","formControlName","date","dateFormat","dd/mm/yy",3,"showIcon","readonlyInput"],[1,"row-two","video-bloc"],["formControlName","hasVideo"],["type","text","pInputText","","formControlName","videoLink",3,"ngClass"],["formControlName","content","placeholder","Renseignez le corps de l'article ici !"],["position","top-right"],["type","submit",1,"add",3,"click"],[1,"pi","pi-plus"],[1,"pi","pi-pencil"],[1,"error-form"],[4,"ngIf"]],template:function(n,e){n&1&&(a(0,"div",0),c(1,"app-page-top-header",1),a(2,"div",2)(3,"button",3),c(4,"i",4),o(5," Annuler "),i(),s(6,fe,3,0,"button",5)(7,ge,3,0,"button",5),i(),a(8,"form",6)(9,"div",7)(10,"div",8),c(11,"img",9),i(),a(12,"div",10)(13,"div",11)(14,"label",12),c(15,"i",13),o(16," Image de couverture "),i(),a(17,"input",14),g("change",function(h){return e.showImagePreview(h)}),i()(),s(18,Ee,2,1,"div",15),i()(),a(19,"div",16)(20,"div",17)(21,"div",18)(22,"label"),o(23,"Rubrique"),i(),c(24,"p-select",19),M(25,"async"),s(26,be,2,0,"small",15),i()(),a(27,"div",17)(28,"div",18)(29,"label"),o(30,"Titre"),i(),c(31,"input",20),s(32,Ce,2,0,"small",15),i()(),a(33,"div",17)(34,"div",18)(35,"label"),o(36,"Description"),i(),c(37,"input",21),s(38,Ae,2,0,"small",15),i()(),a(39,"div",22)(40,"div",18)(41,"label"),o(42,"Heure de l'\xE9v\xEAnement"),i(),c(43,"p-datepicker",23),i(),a(44,"div",18)(45,"label"),o(46,"Date de quand l'\xE9v\xEAnement a eu lieux"),i(),c(47,"p-datepicker",24),s(48,ye,2,0,"small",15),i()(),a(49,"div",25)(50,"div",18)(51,"label"),o(52,"Contiendra une vid\xE9o?"),i(),c(53,"p-toggleswitch",26),i(),a(54,"div",18)(55,"label"),o(56,"Media video"),i(),c(57,"input",27),s(58,Fe,2,0,"small",15),i()(),a(59,"div",17)(60,"div",18)(61,"label"),o(62,"Corps de l'article"),i(),c(63,"p-editor",28),s(64,Se,2,0,"small",15),i()()()(),c(65,"p-toast",29),i()),n&2&&(l(),d("topHeaderData",e.topHeaderPageData()),l(5),I(e.processState()===e.PROCESS_STATE.Create?6:-1),l(),I(e.processState()===e.PROCESS_STATE.Edit?7:-1),l(),d("formGroup",e.articleForm),l(3),d("src",e.imageDisplay,_),l(7),d("ngIf",e.formControls.coverImage.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(6),d("options",W(25,22,e.blogRubrics$))("filter",!0)("showClear",!0),l(2),d("ngIf",e.formControls.rubric.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(6),d("ngIf",e.formControls.title.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(6),d("ngIf",e.formControls.description.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(5),d("readonlyInput",!0)("timeOnly",!0),l(4),d("showIcon",!0)("readonlyInput",!0),l(),d("ngIf",e.formControls.date.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(9),d("ngClass",e.formControls.hasVideo.value?"enabledInput":"disabledInput"),l(),d("ngIf",e.formControls.videoLink.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)),l(5),V(B(24,he)),l(),d("ngIf",e.formControls.content.invalid&&(e.isSaveButtonClicked||e.isEditButtonClicked)))},dependencies:[j,R,N,z,oe,H,U,Y,J,O,G,$,K,Q,ee,Z,ne,ie,te,ue,ae,re,pe,me,se,ce,le],styles:[`.article-add-edit-container{display:flex;flex-direction:column;min-height:100vh}.article-add-edit-container form{display:flex;justify-content:center}.article-add-edit-container form .left{display:flex;flex-direction:column;align-items:center;width:275px;margin-right:20px}.article-add-edit-container form .left .preview{width:100%;height:250px;border-radius:5px;overflow:hidden;background-color:#d3d3d3}.article-add-edit-container form .left .preview img{width:100%;height:100%;display:none;object-fit:cover;object-position:top}.article-add-edit-container form .left .upload{display:flex;flex-direction:column;align-items:flex-start;width:100%;margin-top:15px}.article-add-edit-container form .left .upload .input{display:flex;flex-direction:column;width:100%}.article-add-edit-container form .left .upload .input input{display:none}.article-add-edit-container form .left .upload .input label{width:100%;height:50px;padding:5px 10px;background-color:#fff;color:var(--project-primary-color);border-radius:5px;cursor:pointer;border:solid var(--project-primary-color);display:flex;align-items:center;justify-content:center}.article-add-edit-container form .left .upload .input label:hover{transition:all .3 ease-in-out;background-color:var(--project-primary-color);color:#fff}.article-add-edit-container form .left .upload .input label i{margin-right:7px}.article-add-edit-container form .left .upload small{margin-top:10px}.article-add-edit-container form .right{display:flex;justify-content:center;flex-direction:column;width:700px;border-radius:7px;background-color:#fff;padding:60px;box-shadow:#32325d40 0 13px 27px -5px,#0000004d 0 8px 16px -8px}.article-add-edit-container form .right .row-one{width:100%}.article-add-edit-container form .right .row-two{display:flex;justify-content:space-between}.article-add-edit-container form .right .calendar-bloc .field:first-child,.article-add-edit-container form .right .video-bloc .field:first-child{flex:1;margin-right:20px}.article-add-edit-container form .right .calendar-bloc .field:last-child,.article-add-edit-container form .right .video-bloc .field:last-child{flex:2}.article-add-edit-container form .right .calendar-bloc .field p-datepicker,.article-add-edit-container form .right .video-bloc .field p-datepicker{width:100%}.article-add-edit-container form .right .calendar-bloc .field p-datepicker span,.article-add-edit-container form .right .video-bloc .field p-datepicker span{width:100%}.article-add-edit-container form .right .field{display:flex;flex-direction:column;margin-bottom:20px;flex:1}.article-add-edit-container form .right .field label{margin-bottom:7px}.article-add-edit-container form .right .field small{margin:10px 0 0}.article-add-edit-container form .right .field .disabledInput{background-color:#d3d3d3}.article-add-edit-container form .right .field .enabledInput{background-color:transparent}.article-add-edit-container form .right .field .p-button{color:#fff;background:var(--project-primary-color);border:1px solid var(--project-primary-color)}.article-add-edit-container form .right .field .p-dropdown,.article-add-edit-container form .right .field .p-dropdown span{width:100%}@media all and (max-width: 990px){.add-replay form{width:100%}}@media all and (max-width: 990px){.add-replay form{padding:20px}}
`],encapsulation:2})}}return r})();export{tt as ArticleAddEditContainerComponent};
